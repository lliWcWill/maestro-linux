@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* ── Theme: CSS Variables (RGB triplets for Tailwind alpha support) ── */

  :root {
    /* Dark theme — warm gunmetal, matching macOS Maestro */
    --maestro-bg: 26 26 30; /* #1a1a1e — warm charcoal */
    --maestro-surface: 30 31 35; /* #1e1f23 — sidebar/topbar */
    --maestro-card: 37 37 41; /* #252529 — card/section bg */
    --maestro-border: 51 51 56; /* #333338 — borders */
    --maestro-text: 229 229 233; /* #e5e5e9 — primary text */
    --maestro-muted: 140 140 150; /* #8c8c96 — secondary text */

    /* Accent & status — constant across themes */
    --maestro-accent: 88 166 255; /* #58a6ff */
    --maestro-green: 63 185 80; /* #3fb950 */
    --maestro-red: 248 81 73; /* #f85149 */
    --maestro-orange: 245 158 11; /* #f59e0b — matches design spec */
    --maestro-yellow: 234 179 8; /* #eab308 — needs input */
    --maestro-purple: 188 140 255; /* #bc8cff */
  }

  /* Light theme — clean neutral with strong contrast */
  [data-theme="light"] {
    --maestro-bg: 241 241 243; /* #f1f1f3 */
    --maestro-surface: 252 252 253; /* #fcfcfd */
    --maestro-card: 245 245 247; /* #f5f5f7 */
    --maestro-border: 210 210 216; /* #d2d2d8 */
    --maestro-text: 20 20 24; /* #141418 */
    --maestro-muted: 100 100 112; /* #646470 */
  }

  /* Content area override — always dark regardless of theme */
  [data-theme="light"] .content-dark {
    --maestro-bg: 26 26 30;
    --maestro-surface: 30 31 35;
    --maestro-card: 37 37 41;
    --maestro-border: 51 51 56;
    --maestro-text: 229 229 233;
    --maestro-muted: 140 140 150;
  }

  /* ── Theme transition on chrome (scoped to direct children) ── */
  .theme-transition {
    transition:
      background-color 200ms ease-out,
      border-color 200ms ease-out,
      color 200ms ease-out,
      box-shadow 200ms ease-out;
  }
  .theme-transition > * {
    transition:
      background-color 200ms ease-out,
      border-color 200ms ease-out,
      color 200ms ease-out,
      box-shadow 200ms ease-out;
  }

  html,
  body,
  #root {
    height: 100%;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background-color: rgb(var(--maestro-bg));
    color: rgb(var(--maestro-text));
  }

  /* ── Scrollbar ── */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: rgb(var(--maestro-border));
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgb(var(--maestro-muted) / 0.5);
  }

  html {
    scrollbar-width: thin;
    scrollbar-color: rgb(var(--maestro-border)) transparent;
  }
}

@layer utilities {
  .no-select {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
  }
}

/* ── Terminal Cell Styling ── */

.terminal-cell {
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid rgb(var(--maestro-border));
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.3),
    0 1px 3px rgba(0, 0, 0, 0.2);
  /* Subtle top-edge glass highlight */
  border-top: 1px solid rgba(255, 255, 255, 0.03);
  transition:
    border-color 300ms ease,
    box-shadow 300ms ease;
}

.terminal-cell-idle {
  border-color: rgb(var(--maestro-border));
}

.terminal-cell-starting {
  border-color: rgb(var(--maestro-orange));
  box-shadow:
    0 0 6px rgba(245, 158, 11, 0.15),
    0 0 14px rgba(245, 158, 11, 0.08);
  animation: starting-glow 2s ease-in-out infinite;
}

.terminal-cell-working {
  border-color: rgb(var(--maestro-green) / 0.4);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.3),
    0 0 8px rgba(63, 185, 80, 0.1);
}

.terminal-cell-needs-input {
  border-color: rgb(var(--maestro-yellow) / 0.4);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.3),
    0 0 8px rgba(234, 179, 8, 0.1);
}

.terminal-cell-done {
  border-color: rgb(var(--maestro-accent) / 0.3);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.3),
    0 0 6px rgba(88, 166, 255, 0.08);
}

.terminal-cell-error {
  border-color: rgb(var(--maestro-red) / 0.4);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.3),
    0 0 8px rgba(248, 81, 73, 0.12);
}

/* ── Animations ── */

@keyframes subtle-breathe {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-1.5px);
  }
}

@keyframes glow-pulse {
  0%,
  100% {
    box-shadow: 0 0 8px rgb(var(--maestro-orange) / 0.2);
  }
  50% {
    box-shadow: 0 0 18px rgb(var(--maestro-orange) / 0.4);
  }
}

@keyframes starting-glow {
  0%,
  100% {
    box-shadow:
      0 0 6px rgba(245, 158, 11, 0.15),
      0 0 14px rgba(245, 158, 11, 0.08);
  }
  50% {
    box-shadow:
      0 0 10px rgba(245, 158, 11, 0.25),
      0 0 20px rgba(245, 158, 11, 0.12);
  }
}

@keyframes pod-wake {
  0% {
    transform: scale(0.95);
    opacity: 0.7;
  }
  50% {
    transform: scale(1.02);
    opacity: 0.9;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.animate-breathe {
  animation: subtle-breathe 3s ease-in-out infinite;
}

.animate-glow {
  animation: glow-pulse 2s ease-in-out infinite;
  border-color: rgb(var(--maestro-orange));
}

.animate-pod-wake {
  animation: pod-wake 600ms ease-out forwards;
}

@media (prefers-reduced-motion: reduce) {
  .animate-breathe,
  .animate-glow,
  .animate-pod-wake {
    animation: none !important;
  }
}
